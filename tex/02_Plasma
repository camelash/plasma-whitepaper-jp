\section{Plasma}

プラズマは、コントラクト作成者がアクティブな状態遷移管理をせずに、自律的かつ持続的にチェーンを運営する経済的インセンティブを作成するための構造をもった、ブロックチェーンでスケーラブルな計算を行う方法である。

ノード自体はチェーンを運営するようにインセンティブ化されている。

さらに、ビットマップ内の単一のビットとのコントラクトからの支出として表される資金を最小限に抑えることによって、重要なスケーラビリティが達成され、そのため、1つのトランザクションと署名が、多くの参加者と合体した支払いを表す。

私たちは、結合したスマートコントラクトによって強制された、スケーラブルな計算を構築することができるようにするために、MapReduce [5]のフレームワークとこれを組み合わせる。

この構造により、外部化された当事者は、マイナーに似て、資金を保持して契約を計算することができるが、統合された状態の更新のための最小限のデータをオンチェーンに持ちながら
、Plasmaは既存のブロックチェーンの上で実行されるため、すべての状態更新のために基になるチェーンにトランザクションを作成する必要はない。（新規ユーザーの元帳エントリの追加を含む）

%\ref{fig:hamu}
\begin{figure}[htbp]
  \begin{center}
    %\includegraphics[clip,width=7.0cm]{./img/dummy.eps}
    \caption{誰もがさまざまなユースケースのためのスマート契約のスケーラビリティのためのカスタムPlasmaチェーンを作成することができる}
    \label{fig:a}
  \end{center}
\end{figure}

プラズマは、ルートチェーン内に多くのブロックチェーンをおくことを可能にしたスマートコントラクトのシリーズである。

ルートチェーンはプラズマチェーンの状態を強制する。

ルートチェーンは、世界的にすべての計算の執行者であるが、詐欺の証拠がある場合にのみ、計算され、ペナルティが課される。

多くのPlasmaブロックチェーンは、独自のビジネスロジックとスマートコントラクトの条項と共存することができる。

イーサリアムでは、プラズマはイーサリアムで直接実行されるEVMスマートコントラクトで構成されるが、non\-Byzantineの場合には、非常に大量の計算と財務会計記録を表すことができる小さなコミットメントしか処理しない。

プラズマは、5つの主要コンポーネントで構成される。

経済的に効率的な方法で契約を永続的に計算するためのインセンティブ層、
低コストの効率とトランザクションのネット決済を最大限にするための、ツリー形式で子チェーンを配置するための構造、
これらのネストされたチェーン内での状態遷移の詐欺証明を構築してツリー構造と互換性があり、状態遷移を高度にスケーラブルに再構成するためのMapReduceコンピューティングフレームワーク
Nakamoto [6]コンセンサスインセンティブの結果を再現しようとするルートブロックチェインに依存するコンセンサスメカニズム
ルートブロックチェーンからの正確な状態遷移を確実にし、mass\-exitコストを最小限に抑えるためのビットマップ \- UTXOコミットメント構造。

データの利用不可能性やその他のビザンチンな行動の終了を可能にすることは、Plasmaの運用における重要な設計ポイントの1つである。


\subsection{Plasmaブロックチェーン、または外部化された複数のチャンネル}

我々は、マルチパーティーオフチェーンチャネルが他者のために状態を保持できる方法を提案する。

私たちはこのフレームワークをPlasmaブロックチェーンと名付ける。

Plasmaチェーンで保有されている資金については、これにより、Plasmaチェーンへの資金の預金および払戻しが可能になり、詐欺の証拠によって状態の移行が強制される。

これは、ルートチェーンに保持されている資金と一致するPlasmaブロックを考慮して、預金と出金が可能であるため、強制的な状態と代替性を可能にする（Plasmaはフラクショナルリザーブバンク設計に適合するようには設計されていない）。

%\ref{fig:hamu}
\begin{figure}[htbp]
  \begin{center}
    %\includegraphics[clip,width=7.0cm]{./img/dummy.eps}
    \caption{Plasmaブロックチェーンは、ブロックチェーン内のチェーンである}
    \label{fig:a}
  \end{center}
\end{figure}


このシステムは、詐欺の拘束証明によって強制される。

Plasmaブロックチェーンは、ルートチェーン上（例、イーサリアム）のブロックチェーンの内容物を明らかにしていない。

その代わりに、ブロックヘッダハッシュがルートチェーン上に提出され、ルートチェインに詐欺が提出されたことが証明された場合、ブロックはロールバックされ、ブロック作成者にペナルティが課せられる。

これは非常に効率的で、多くの状態の更新は、単一のハッシュ（いくつかの小さな関連データ）で表される。

この更新は、ルートブロックチェーンには表示されない残高を表すことができる（アリスはルートチェーン上の元帳残高を持たず、元帳はPlasmaチェーン上にあり、ルートチェーン内の残高はPlasmaチェーン自体を強制するスマートコントラクトを表している。）

灰色のアイテムは古いブロックであり、黒はルートチェーン上で伝播されコミットされた最新のブロックである。

信じられないほど大量のトランザクションがこのPlasmaチェーンでコミットされ、ルートブロックチェーンに入るデータは最小限に抑えられる。


参加者は、既存の参加者ではない参加者への転送を含む、誰にでも資金を移転することができる。

これらの転送は、ルートブロックチェーンの本来のコイン/トークンに資金を払い込んで（多少の時間遅延と証拠で）資金を引き出すことができる。

Plasmaでは、ルートブロックチェーン上の元帳の完全な永続的な記録なしに、第三者に保管上の信頼を与えることなく、誰か（または、Proof of Stakeの参加者のネットワーク）がブロックチェーンを管理できるようになる。

最悪の場合、資金はロックされ、time\-valueはブロックチェーン上のmass\-exitsによって失われる。

私たちは、このチャンネルで状態を強制するルートブロックチェーン上のスマートコントラクト[7]として一連の不正防止プルーフを構築し、不正行為または非ビザンチン行為の試みを削ることができる。

これらの詐欺証明は、資金出金のインタラクティブプロトコルを強制する。

ライトニングネットワークと同様に、資金を引き出す際には、Exitには時間が必要である。


私たちは、出席者が出金を要求するUTXOモデルに配置された、参加者の元帳OUTPUTのビットマップを証明する、インタラクティブゲームを構築する。

ネットワーク上の誰でも、既に資金が使われているかどうかを証明する代替*bonded*証明書を提出することができる。

これが間違っている場合、ネットワーク上の誰も不正行為を証明し、認証をロールバックするためにbondsを破棄することができる。

十分な時間が経過すると、2番目の*bonded*ラウンドでは、コミットされたタイムスタンプの*前*の状態のbondである引き出しを行うことができる。

これは、欠陥のあるPlasmaチェーンが急速に終了するように、一括して取り出すことを可能にする。

調整された大量出金イベントでは、参加者は、親ブロックチェーンで消費されるブロックスペースが2ビット未満で終了することがある（すなわち、ワーストケースのシナリオではオンチェーンのイーサリアム）

Block withholding攻撃が発生した場合、参加者は迅速かつ安価に大量退出を行うことができ、これまでのオフチェーンの提案と比較して大幅なコスト削減が可能である。

さらに、これは承認ノードの連合（Sidechain Functionaries、Fishermen）に信頼を置いていない。


%\ref{fig:hamu}
\begin{figure}[htbp]
  \begin{center}
    %\includegraphics[clip,width=7.0cm]{./img/dummy.eps}
    \caption{Block wtihholdingの場合の資金の出金}
    \label{fig:a}
  \end{center}
\end{figure}

赤いブロック（ブロック＃4）は、ルートチェーン上で保留されコミットされたブロックであるが、アリスはプラズマブロック＃4を取得できない。

彼女はルートチェーンに資金の証拠を伝播することによってExitし、出金は紛争を許容するために遅れて処理される。

ライトニングネットワークを閉じる方法と同様に、2人の参加者間で無制限の支払いを可能にするためのインタラクティブなメカニズムであり、これにより、n人の参加者間のインタラクティブなメカニズムが可能になる。

主な違いは、すべての参加者が状態を更新するためにオンラインになる必要はなく、参加者は参加を可能にするためにルートチェーンにエントリの記録を必要としないことである。

これらのPlasmaチェーンを、ツリー形式で構築する際に取引を確認するための最小限のデータで、オン・チェーンで直接的な相互作用なしにPlasmaに資金を置くことができる。

ブロックチェーンの強制されたブロックチェーン

%\ref{fig:hamu}
\begin{figure}[htbp]
  \begin{center}
    %\includegraphics[clip,width=7.0cm]{./img/dummy.eps}
    \caption{Plasmaはツリー状にブロックチェーンを構成する}
    \label{fig:a}
  \end{center}
\end{figure}

ブロックコミットメントはフローダウンし、終了は任意の親チェーンに提出でき、最終的にルートブロックチェーンにコミットされる。


\subsection{強制可能なブロックチェーンの中にあるブロックチェーン}

我々は裁判制度と同様の仕組みを構築する。

ライトニングネットワークが最終的にルートチェーン上で執行可能な支払いのために裁定層を使用する場合、non\-Byzantineの状態では可用性を最大限に高め、コストを最小限に抑えるために、裁判所の上層階と下層階のシステムを作成する。


チェーンがByzanitneの場合は、その親（ルートブロックチェーンを含む）のいずれかに行き、現在のコミットされた状態で実行を続行するか終了するかを選択できる。

Inctementing\-nonce状態（取り消しを介して）を実行する代わりに、これらの連鎖階層の残高と状態遷移を強制する詐欺証明のシステムを構築する。

実際には、親チェーンに定期的にコミットされるだけの状態遷移を作成することができる。（ルートブロックチェーンに流れる）。

これにより、ビザンチン条件で親（またはルート）チェーンにraw dataを送信することしかできないため、計算量とアカウント状態の驚異的なスケールが可能になる。

ビザンチンの部分的な状態からの復旧は、親プラズマ・チェーンに行って状態を強制することができるため、コストを最小限に抑える。

この子ブロックチェーンはルートブロックチェーン（Ethereumなど）の上で実行され、ルートブロックチェーンの観点からは、ブロックチェーンのProof of Stakeコンセンサスルールとビジネスロジックの実施のために契約でトークンが結合された定期的なコミットメントのみが表示される。

これは、ブロックの可用性を最大化し、コインの承認のためのStakeを最小限に抑える上で重要な利点を有する。

ただし、すべてのデータがすべての関係者に伝播されるわけではないため（特定の状態を検証したい人のみ）、当事者は、彼らが定期的に興味を持っている特定のチェーンを監視し、詐欺行為を罰する責任があり、同様にBlock withholding攻撃の場合には、個人的にチェーンを急速に脱出する。

%\ref{fig:hamu}
\begin{figure}[htbp]
  \begin{center}
    %\includegraphics[clip,width=7.0cm]{./img/dummy.eps}
    \caption{障害のあるブロックチェーン（赤で塗りつぶされている）は、その親のPlasma およびルートチェーン（右の点線の青い線）にコミットメントをブロードキャストすることでルーティングができる}
    \label{fig:a}
  \end{center}
\end{figure}

第3階層目のPlasmaチェーンの参加者は、一定期間後に別のチェーンに一緒に移動する（青色の点線）。


この構造は、非ビザンチン環境では、ブロックチェーンの状態のツリーを結合し、すべてのPlasmaチェーンを更新する。

すべてのチェーンにわたる更新セット全体は、署名付きの32バイトハッシュで証明され。


\subsection{Plasma の Proof of Stake}

単一のバリデーターで他者の代わりに資金を保持することは非常に興味深いが、単一の当事者が一連のバリデーターを使い、多くのケースではETH担保やトークンによる担保（例えば、ERC-20）を必要とするPoSフレームワークにて、stateを実行できる方法を提案する。 

このPoSシステムの証拠に対するコンセンサスの仕組みもまた、オンチェーンなスマートコントラクトで実施されてい。

私たちはナカモトコンセンサスに関するインセンティブを同様のものを作ろうとしており、それはPoSの担保を使用する。 ナカモトコンセンサスの結果として構築されたより有益なインセンティブ・メカニズムの1つは、Block Withholding Attackを最小限に抑える大きなインセンティブであるということを我々は信じてい。 なぜならリーダーは確率的に選出されているに過ぎないからだ。 リーダーは、時間の経過とともに確率論的に確定していき（元の実装では、それが6承認であった）。 ブロックを見つけたら、自身がリーダーになる可能性はかなり高いと確信できが、実際にリーダーであるかどうかはまだ分かりません。 彼らがリーダーであることを確実にするために、ネットワーク上のすべての参加者にブロックを伝播させて、オッズを最大にする。 私たちは、これがナカモトコンセンサスの重要な貢献ではないとしてもこの事実が重要であり、このインセンティブを再現しようと考えてい。


一人のリーダー投票を行う場合、多数派カルテルによるBlock Withholding Attack（「データ可用性の問題」として一般化されている）が深刻化する可能性があるため、PoSによる連立はこの課題に直面してい。


ステークホルダーが新しいブロックのコミットされたハッシュを含むルートブロックチェーンまたは親Plasmaチェーンにパブリッシュできるようにすることで、Plasma Proof-of-Stakeでこれを軽減でき。 バリデータは、完全に検証されたブロックに基づいて作成され。 彼らはブロックを並行して構築することができ（最大限の情報共有を促進するため）。 我々はより多くの取引手数料が報酬として支払われるようにすることで、過去100ブロックが現在のステイカー比率（つまり、もし誰かがの3％の通貨を占めている場合、それは過去100ブロックの3％を占めるべきである）に合わせたインセンティブを作成する。  余分な手数料は（ステイカーによる準最適な行動のため）将来的に手数料を払うためのプールに送り。 コミットメントは、過去の100ブロック（ノンスを含む）のデータを含むすべてのブロックに存在する。 正しいチェーンチップは、最も高い料金の合計重量を持つチェーンだ。 ある期間が経過すると、ブロックがファイナライズされ。

%\ref{fig:hamu}
\begin{figure}[htbp]
  \begin{center}
    %\includegraphics[clip,width=7.0cm]{./img/dummy.eps}
    \caption{アリス、ボブ、キャロルは同じ重みの3人のバリデータであるとする。 それらは集合的に最大の利益を得るためにラウンドロビン構造を構築するようインセンティブを与える。 これらのコミットメントは親/ルートチェーンに提出され。 チェーン先端は、n周期にわたるブロックの正確な分布によって最大重量スコアに依存する（青は現在の候補鎖先端であり、赤は孤立している）。 準最適なチェーンチップは、ある閾値（例えば90％）以上の正確さを有する将来のバリデーターのためにプールに入る余分な料金をすべて有する。 n時間後に、青いチェーンチップが確定したと推定され}
    \label{fig:a}
  \end{center}
\end{figure}

これは参加者に参加を促し、ナカモトコンセンサスの51％攻撃の仮定と同様のものを再現する。 ブロック保留やその他のビザンチン行動によってチェーンが攻撃された場合、ビザンチン以外の参加者は、親/ルートブロックチェーンで大規模なexitを行い。 最も親のPlasmaチェーンの担保がトークンの形になっている場合、大量exitの結果としてトークンの価値が著しく下落する可能性がある。


\subsection{MapReduceとしてのブロックチェーン}

blockchain : git :: Plasma : Hadoop (MapReduce)
（BlockchainはgitでありPlasmaでありHadoopである）


MapReduce形式で演算を構成することで、階層ツリー内で計算やstate遷移を設計することも容易だ。

MapReduceは、何千ものノードを対象とした大規模計算のためのフレームワークを提供する。 ブロックチェーンは演算のスケーリングを満たす上で同様の問題に直面するが、演算の証明を生成するという追加要件がある。

図7：青は、親ブロックで子に渡されたメッセージだ。子供は、いくつかのn個のブロック内で親ブロックにコミットしなければならず、そうでなければチェーンの停止に直面する。ブロックデータは、計算にコミットしている子どもに仕事を分散する。第3レベルの子供は計算を行い、単語リストを返す（例えば、単語 "Hello"の3回の出現、単語 "World"の2回の出現を彼らが計算を担当する章でカウントする）返す。単語リストデータは、コミットメントの一部として親に返され、単語リストは子から一つに結合されて親に提出され、最終的にグローバルな単語リストを完成させる（例えば、コーパス全体に100の "Hello"インスタンスと150インスタンスの単語"world"といったもの）。これは、非常に大量のデータと作業を網羅するにあたり、ルートチェーン上でコミットされた1つのブロックヘッダー/ハッシュのみで、経済的に実行可能な計算を可能にする。不正の証明が提出されている場合のみブロックは不正とされ、それ以外の場合、極端に少ない量のデータがルートチェーンに定期的に送信され。

我々は、マップフェーズが入力として計算へのデータへのコミットメントを含む方法を提案し、reduceステップにおいて、結果を返すときにマークル化されたstate遷移証明を含む方法を提案する。 マークル化されたstate遷移は、ルートブロックチェーン上に構築された不正の証明によって強制執行され。 また、zk-SNARKsによるstate遷移の証明を構築することも可能だ。 いくつかの計算構造では、reduceステップでビットマップを使用する必要がある（したがって、これらのユースケースに対してUTXO /アカウントごとに2つ以上のビットを使用でき）。


私たちの構成は、時間またはスピードのトレードオフを伴う驚異的な大規模計算を可能にする。これらのトレードオフは、ノードが計算を実行し、参加者がそれらの検証を担当するネットワークを生成する。これは信頼なしで計算を完全に委託することができるシステムを作るわけではなく、計算を担保証明に圧縮することを可能にする。これらの担保証明は参加者に事実を正直に証明するよう促する。これは、Lightning Networkと同様の形式であり、樹木が森に落ちたとして、誰もそれを聞いていないなら音が出るかどうかは関係ないということだ。同様に、計算を監視/実行している人が誰もいない場合は、正しいと見なされるか、結果が何であるかは重要ではありません。オープンネットワークの参加者は誰でもコンピューティングを監視することができが、資金を保持し正しい計算を要求する参加者は定期的にチェーンを監視して正確性を保証する。スケーリングのメリットは、経済的な影響を受けていないチェーンを見る必要性を排除したことからもたらされ、結果として自身が正しい行動を強制したいチェーンについて自身で監視する必要がある。他のプラズマ・チェーン上の挙動は、reduceステップの一部としてネッティングすることができるので、影響を受ける計算は最小限のstateで表現される。たとえば、分散型取引所の場合、どの取引先がどの注文をしているか気にしないで、一つの合算された注文書を見るだけでよいので、他のすべての取引先を単一の取引先として観測するだけでよいが、自身のチェーンはトランザクションを実行し正しい人（自分自身を含む）に注文を行うよう完全に検証されてい。もう1つの例として、Plasmaチェーンのツリー上にBBSを構築することができ、関与していないトピックに関する更新を受け取る必要はないというものがある。

%\ref{fig:hamu}
\begin{figure}[htbp]
  \begin{center}
    %\includegraphics[clip,width=7.0cm]{./img/dummy.eps}
    \caption{ユーザーは自身が実行したいデータを見るだけ十分だ。 執行する必要がない（グレー）他のプラズマチェーンで経済活動や計算が行われる場合、他のすべてのチェーンを単一のカウンターパーティとして扱うことができ。 例えば。 プラズマ分散型の交換では、自分の約束に影響を与える鎖を見るだけでよい（太字の青色）}
    \label{fig:a}
  \end{center}
\end{figure}


\subsection{永続的・非中央集権的・自律的なブロックチェーンの経済的インセンティブに関する解説}

私たちは、子ブロックチェーンを継続的に稼動させるための経済的インセンティブを生むことができる構造を提案する。 過剰な複雑性またはstate遷移に依存する必要のないstateでは、stateの担保にネイティブトークン（例えば、ETH用のETH）を使用することができ。 しかし、複雑なコントラクトの場合、システムの健全性と公平性を保証するインセンティブがあることによるチェーンを継続するための大きなインセンティブが存在する可能性がある[8][9]。

すべてのプラズマチェーンは一連のコントラクトによって表され。 これらのコントラクトはチェーンのコンセンサスルールを執行し、不正が発生する可能性がある場合、不正に対し重大な罰則が適用され。

しかし、特に正当性と生存に関するビザンチンなstate避けるため、コントラクトごとにトークンを作成するのが理想的かもしれません。 このトークンは、コントラクトの運用におけるネットワーク効果を表し、このコントラクトのセキュリティを最大限に高めるインセンティブを作り出する。 PlasmaチェーンはPoS構造でネットワークを保護するためにトークンを必要とするため、ステイカーはトークンの価値を損なう可能性があるビザンチンな行動や不正に対して逆のインセンティブ付けがなされてい。 トークンの役割は、トークンの値の減少を通じて、バリデータに特化された不正な行為に対するコストの存在を保証することだ。

ユーザーに代わって資金を保有する基本的なコントラクトアカウントのような単純なコントラクトやビジネスロジックを持つことで、Ethereumの担保はPlasmaチェーンのステークを表すことができ。

（それがトークンであろうとETHであろうと）担保を発行するステークは、ネットワークを運用する際に取引手数料を受け取るため、ネットワークの運用を継続するインセンティブを有している。 これらの取引手数料はネットワークのステイカーに払い出され、非ビザンチンの行動を促し、トークンの長期価値を創出する。

ステイカーはこのネットワークを継続運用して取引手数料を徴収するインセンティブを持っているので、チェーンを永続的に運営し、ルートブロックチェーンのコントラクトで定義されている不正証拠に束縛され。
